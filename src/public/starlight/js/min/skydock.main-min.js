!function(){"use strict";var e=Backbone.View.extend({el:"#skydock",cameraPosition:{x:0,y:0},views:[],viewTemplates:[],models:[],modelTemplates:[],planetCollection:null,planetViews:[],model:null,$crosshair:null,discoveredPlanetCount:0,sounds:[],talkingCounter:1,initialize:function(){$(function(){skydock.$crosshair=$("#crosshair"),skydock.views.galaxy=new skydock.viewTemplates.GalaxyView,skydock.views.ship=new skydock.viewTemplates.ShipView,skydock.views.hud=new skydock.viewTemplates.HUD,skydock.views.startMenu=new skydock.viewTemplates.StartMenu,skydock.views.goldStar=new skydock.viewTemplates.GoldStarView,skydock.views.credits=new skydock.viewTemplates.CreditsView,skydock.initSounds(),skydock.centerOnPlayer(),skydock.views.startMenu.cycleStartBtn(),window.on_resize(skydock.centerOnPlayer),$(document).keyup(function(e){"undefined"!=typeof skydock.views.ship.dockedPlanet&&null!==skydock.views.ship.dockedPlanet&&32===e.keyCode&&skydock.views.ship.dockedPlanet.nextMessage()}),skydock.planetCollection.each(function(e){"jason"===e.get("personality")?skydock.planetViews.jason=new skydock.viewTemplates.JasonView({model:e}):"stephanie"===e.get("personality")?skydock.planetViews.stephanie=new skydock.viewTemplates.StephanieView({model:e}):skydock.planetViews.push(new skydock.viewTemplates.PlanetView({model:e}))})})},initSounds:function(){skydock.sounds.main=new Howl({urls:["sound/main.mp3"],loop:!0,volume:.425}),"on"!==localStorage.getItem("music-mute")?skydock.sounds.main.play():skydock.views.startMenu.$el.find(".mute-btn-music").addClass("muted"),"on"===localStorage.getItem("sfx-mute")&&(skydock.views.startMenu.$el.find(".mute-btn-sfx").addClass("muted"),Howler.mute()),skydock.sounds.crosshair=new Howl({urls:["sound/crosshair.mp3"],volume:.175}),skydock.sounds.powerup=new Howl({urls:["sound/powerup.mp3"],volume:.3}),skydock.sounds.coin=new Howl({urls:["sound/coin.mp3"],volume:.4}),skydock.sounds.talking1=new Howl({urls:["sound/talking-1.mp3"],volume:.15}),skydock.sounds.talking2=new Howl({urls:["sound/talking-2.mp3"],volume:.15}),skydock.sounds.talking3=new Howl({urls:["sound/talking-3.mp3"],volume:.15}),skydock.sounds.talking4=new Howl({urls:["sound/talking-4.mp3"],volume:.15}),skydock.sounds.talking5=new Howl({urls:["sound/talking-5.mp3"],volume:.15})},placeCrosshair:function(e){tween.set(skydock.$crosshair,{left:e.x,top:e.y,autoAlpha:1})},hideCrosshair:function(){tween.set(skydock.$crosshair,{autoAlpha:0})},moveTo:function(e,o,t){var s=$(window).width()/2,n=$(window).height()/2,i={};i.x=-1*e.x+s,i.y=-1*e.y+n,tween.to(skydock.views.ship.position,o,{x:e.x,y:e.y,ease:Quad.easeOut,onUpdate:function(){tween.set(skydock.$el,{x:-1*skydock.views.ship.position.x+s,y:-1*skydock.views.ship.position.y+n})},onComplete:function(){"function"==typeof t&&t()}}),o>0&&skydock.sounds.crosshair.play()},centerOnPlayer:function(){skydock.moveTo(skydock.views.ship.position,0),skydock.hideCrosshair()}});window.skydock=new e}(),function(){"use strict";var e=Backbone.Collection.extend({model:skydock.modelTemplates.PlanetModel});skydock.planetCollection=new e,skydock.modelTemplates.PlanetModel=Backbone.Model.extend({defaults:{name:"Happy Planet",greeting:[],position:{x:0,y:0},color:"green",size:"small",personality:"continents"}}),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Jason Majors",greeting:["Hey you!  Slowpoke!  Come over here!","Are you by any chance exploring?","Are you a great explorer?","Can you help a planet out?","Can you deliver this letter to . .. Stephanie Starlight?","She's my girlfriend, but our orbits have kept us apart . . ."," . . . for a couple millenia . . .","So help me out, ya?","I'll give you this awesome engine I have in exchange!","Thanks.  And good luck, young traveler.","She's out there somewhere . . ."],position:{x:3700,y:4175},color:"blue",size:"medium",personality:"jason"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Stephanie Starlight",greeting:["Over here!  I'm over here!","Hello, young traveler.  I heard you were looking for me.","Have you come far?","Oh my, a letter from Jason Majors?","One moment while I read .. . .."," . ... .."," ...... .","Oh my gosh, I love that planet so!","He's the most romantic Class M I've ever met.","I don't know how to thank you!","Here, take this!  It's a gold star!","It will increase your top speed,","And make you even prettier than you already are!","May your travels be swift, mighty explorer.","I will always remember how you helped us."],position:{x:6500,y:500},color:"yellow",size:"medium",personality:"stephanie"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Pluto",greeting:["I was IN, but just like that, just like that . .  .","You believe in me, don't you?"],position:{x:4700,y:3800},color:"small",size:"gray",personality:"worried"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Romeo",greeting:[],position:{x:3e3,y:3e3},color:"gray",size:"small",personality:"dead"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Juliet",greeting:[],position:{x:3150,y:3e3},color:"gray",size:"small",personality:"dead"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Jack",greeting:["Promise me you'll survive.","That you won't give up, no matter what happens, no matter how hopeless.","Never let go."],position:{x:4550,y:5e3},color:"sand",size:"small",personality:"determined"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Rose",greeting:["I'll never let go, Jack. I'll never let go.","I promise."],position:{x:4850,y:4950},color:"orange",size:"large",personality:"scared-left"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Hyper Hector",greeting:["Heading to deep space, young one?","There's Sirius Black holes out there.","No joke."],position:{x:3250,y:4650},color:"red-2",size:"medium",personality:"hopeful"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Saturn",greeting:["Want to hear my poem?","One Ring to rule them all,","One Ring to find them,","One Ring to bring them all and in the darkness bind them . . .","In the land of Saturn where rings are awesome!"],position:{x:5750,y:4350},color:"red-2",size:"large",personality:"hopeful"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Gaia",greeting:["Perhaps I'm just a stepping stone in evolution?","Perhaps humans will adapt . . . "," . . . to outlive me?"],position:{x:4450,y:5950},color:"earth",size:"medium"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Luna Lovegood",greeting:["I'm glad you're here, it's like being with a friend.","And don't worry, you're not going mad,","I see them too."],position:{x:4050,y:6100},color:"gray",size:"tiny"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Hagrid",greeting:["Crikey, I'd love a dragon.","Oh, and . . .","also . . ."," . . . . . . . ","You're a wizard, 'Arry."],position:{x:2e3,y:4150},color:"red",size:"large",personality:"determined"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Snape Supernova",greeting:["You have your mother's eyes.","But your father was a swine.","50 points from gryffindor."],position:{x:5e3,y:3150},color:"green",size:"medium",personality:"bully"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Goat",greeting:["HAYY","HAYYYYYYyYYY","-","HAYYyY"],position:{x:4020,y:2500},color:"orange",size:"large",personality:"stupid"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Kashyyyk",greeting:["Wyaaaaaa. Ruh ruh.","Ruh gwyaaaag.","Gu waagaa ahawag?","Ruow."],position:{x:1020,y:4500},color:"green",size:"small"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Spiceworld",greeting:["Yo I'll tell you what I want, what I really really want!","So tell me what you want, what you really really want! ","I wanna <_<","I wanna >_>","I wanna <_<","I wanna >_>","I wanna really,","really really wanna zigazig ha!"],position:{x:6020,y:2225},color:"sand",size:"large"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Dune",greeting:["Remember, young traveler:","He who controls the spice controls the universe."],position:{x:2020,y:2225},color:"sand",size:"large"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Tupac",greeting:["Nah man, that's not me . . .","I get that all the time . . .","Seriously, my name's Herbert.","Enough with the questions!","I'm not a killa, but don't push me."],position:{x:7020,y:1225},color:"green",size:"large",personality:"grumpy"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Britney",greeting:["La la la la la hemm hemmmmm"," // Too high, can't come dowwnnn // "," // Losing my head, spinning round and round //"," // Do you feel me now? // ","hemmm hemmmmmm . . ."],position:{x:7020,y:3225},color:"red",size:"large",personality:"happy"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Footman",greeting:["Awaiting orders","Your command?","Yes, sire?","Are you still touching me?",'"Join the army," they said.','"See the world," they said.',"I'd rather be sailing."],position:{x:3500,y:1500},color:"gray",size:"small",personality:"determined"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Waldo",greeting:["Oh man!","You got me!","What??!","You're looking for someone else?","MMHufff."],position:{x:1500,y:1500},color:"waldo",size:"medium",personality:"scared"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Planet Fitness",greeting:["Hey,","You're not a lunk, are you?","I hate lunks.","Don't judge me."],position:{x:2e3,y:500},color:"purple",size:"medium",personality:"bully"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Aesop Rock",greeting:["Must not sleep . . . ","Must warn others . . . "],position:{x:3200,y:800},color:"red",size:"large",personality:"determined"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Elvis Presley",greeting:["I'm trying to keep a level head,","You have to be careful out here in the galaxy.","It's so easy to get turned around."],position:{x:600,y:6200},color:"red-2",size:"large",personality:"determined"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Yoda",greeting:["Know your quest,","I do.","Learn to trust your instincts,","You will.","Make more money off Star Wars,","They will."],position:{x:4750,y:900},color:"green",size:"small",personality:"worried"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Ferris",greeting:["Haccmmmkkk mehhhh","Ofjjjjjjjjckckkk","I'm so sick."," . . . You're still here? It's over!"],position:{x:2e3,y:6600},color:"green",size:"small",personality:"worried"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Atlas",greeting:["HARRRREERRRRRRRR","Lend a hand?"],position:{x:5400,y:7e3},color:"red-2",size:"small",personality:"grumpy"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Celestial Sphere",greeting:[" . . . hee hee . . .","I'm heavy!"," . . . hee hee . . ."],position:{x:5400,y:6845},color:"gray",size:"large"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Lego",greeting:["Everything is awesome!","Everything is cool when you're part of a team!","Everything is awesome when we're living our dream!","Everything is awesomeeeeee!"],position:{x:7200,y:4900},color:"yellow",size:"small",personality:"happy"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"A Moon?",greeting:["Fully operational!"],position:{x:6e3,y:5500},color:"deathstar",size:"small",personality:"evil"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Allison Asteroid",greeting:["Stephanie Starlight?","Oh ya!  She's my friend!","I'll let her know you're looking for her."],position:{x:3100,y:3500},color:"yellow",size:"small",personality:"hopeful"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Kayla Celestial",greeting:["Do you like to read?","I'd love some suggestions."],position:{x:6200,y:3375},color:"purple",size:"small",personality:"happy"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Franky Photon",greeting:["Don't bother me, kid.","Beat it."],position:{x:1200,y:2775},color:"orange",size:"medium",personality:"grumpy"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Jennifer Jethead",greeting:["O.M.G.","You are just the cutest little ship I've ever seen.","You can orbit me any time you like!"],position:{x:1325,y:5175},color:"yellow",size:"small",personality:"happy"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Ralph Radiowave",greeting:["What's that?","You're looking for Stephanie Starlight?","Me too!","She's a class 10 hottie!"],position:{x:2790,y:5575},color:"orange",size:"medium",personality:"hopeful"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Puppy",greeting:["Puppy is a world run by cats.","Cats love irony.","And lasers.","Irony and lasers."],position:{x:790,y:1e3},color:"green",size:"small",personality:"evil"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Sarah",greeting:["Hello little ship,","I'm just a slave . . ."," . . . a slave to the solar system."],position:{x:4500,y:1700},color:"blue-2",size:"medium",personality:"sad"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Geoffrey Galactic",greeting:["Stephanie Starlight?","Last I saw, her vector put her in the far reaches."],position:{x:7e3,y:6500},color:"red",size:"large",personality:"hopeful"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Kevin Kelvin",greeting:["Stephanie Starlight is supernova hot!","Good luck, little buddy . . . ","You're going to need it."],position:{x:1300,y:7100},color:"orange",size:"large",personality:"evil"})),skydock.planetCollection.add(new skydock.modelTemplates.PlanetModel({name:"Sheep",greeting:[" . . . . . "," . . . "," . . . . .  "," . . . "," . . . . .  "," . . . "],position:{x:4e3,y:7100},color:"yellow",size:"large",personality:"stupid"}))}(),function(){"use strict";skydock.viewTemplates.StartMenu=Backbone.View.extend({el:"#start-menu-wrapper",events:{"click .start-game":"startGame","click .show-credits":"showCredits","click .mute-btn-music":"toggleMusicMute","click .mute-btn-sfx":"toggleSFXMute"},visible:!0,firstStart:!0,initialize:function(){},cycleStartBtn:function(){skydock.views.startMenu.visible&&tween.to(skydock.views.startMenu.$el.find(".start-game"),.9,{autoAlpha:1,ease:Quad.EaseInOut,onComplete:function(){tween.to(skydock.views.startMenu.$el.find(".start-game"),1.2,{autoAlpha:.65,ease:Quad.EaseInOut,onComplete:function(){skydock.views.startMenu.cycleStartBtn()}})}})},startGame:function(){skydock.views.startMenu.visible=!1,tween.to(this.$el,1,{autoAlpha:0,onComplete:function(){var e=skydock.views.startMenu.$el.find(".start-game");e.text("Resume Game"),tween.set(e,{autoAlpha:1})}}),skydock.sounds.powerup.play(),this.firstStart&&(skydock.planetViews.jason.showGreeting(),skydock.planetViews.stephanie.showGreeting(),this.firstStart=!1)},openMenu:function(){tween.to(this.$el,.8,{autoAlpha:1}),skydock.sounds.powerup.play()},toggleMusicMute:function(e){var o=$(e.currentTarget);o.hasClass("muted")?(o.removeClass("muted"),skydock.sounds.main.play(),skydock.sounds.powerup.play(),localStorage.setItem("music-mute","off")):(o.addClass("muted"),skydock.sounds.main.pause(),localStorage.setItem("music-mute","on"))},toggleSFXMute:function(e){var o=$(e.currentTarget);o.hasClass("muted")?(o.removeClass("muted"),Howler.unmute(),skydock.sounds.powerup.play(),localStorage.setItem("sfx-mute","off")):(o.addClass("muted"),Howler.mute(),localStorage.setItem("sfx-mute","on"))},showCredits:function(){skydock.sounds.powerup.play(),skydock.views.credits.render()}}),skydock.viewTemplates.GalaxyView=Backbone.View.extend({el:"#galaxy",events:{click:"onClick"},onClick:function(e){var o=$(window).width()/2,t=$(window).height()/2,s=e.clientX-o,n=e.clientY-t,i={x:skydock.views.ship.position.x+s,y:skydock.views.ship.position.y+n};skydock.views.ship.flyTo(i),skydock.placeCrosshair(i)}}),skydock.viewTemplates.HUD=Backbone.View.extend({el:"#hud",events:{"click .options-btn":"optionsClick"},initialize:function(){this.updateCounter()},updateCounter:function(){var e=this.$el.find(".planet-counter");e.text("Discovered "+skydock.discoveredPlanetCount+" of "+skydock.planetCollection.length+" planets")},optionsClick:function(){skydock.views.startMenu.openMenu()}}),skydock.viewTemplates.ShipView=Backbone.View.extend({el:"#ship",size:{width:0,height:0},centerOrigin:{x:0,y:0},position:{x:4e3,y:4e3},speed:100,events:{},initialize:function(){this.size.width=this.$el.outerWidth(),this.size.height=this.$el.outerHeight(),this.centerOrigin.x=this.size.width/2,this.centerOrigin.y=this.size.height/2},flyTo:function(e,o){var t={x:e.x-skydock.views.ship.position.x,y:e.y-skydock.views.ship.position.y},s=Math.atan2(-1*t.x,t.y);tween.to(skydock.views.ship.$el,.3,{rotationZ:s+"rad_short"});var n=e.x-skydock.views.ship.position.x,i=e.y-skydock.views.ship.position.y,l=(Math.abs(n)+Math.abs(i))/skydock.views.ship.speed;skydock.moveTo(e,l,o),"undefined"!=typeof this.dockedPlanet&&(this.dockedPlanet.hideGreeting(),this.dockedPlanet=void 0,tween.to(skydock.views.ship.$el,.5,{scale:1,autoAlpha:1}))}}),skydock.viewTemplates.PlanetView=Backbone.View.extend({className:"planet",model:null,template:_.template($("#skydock-planet-template").html()),currentMessageIndex:0,discovered:!1,events:{click:"onClick"},initialize:function(){null!==this.model&&(tween.set(this.$el,{left:this.model.get("position").x,top:this.model.get("position").y}),this.$el.html(this.template(this.model.toJSON())),this.$el.addClass(this.model.get("size")).addClass(this.model.get("color")).addClass(this.model.get("personality")),skydock.$el.append(this.$el))},onClick:function(){skydock.views.ship.dockedPlanet!==this&&(skydock.views.ship.flyTo(this.model.get("position"),_.bind(this.landing,this)),skydock.hideCrosshair(),this.showGreeting(),this.discovered===!1&&(skydock.discoveredPlanetCount++,skydock.views.hud.updateCounter(),this.discovered=!0))},landing:function(){tween.to(skydock.views.ship.$el,2,{scale:.4}),skydock.hideCrosshair()},showGreeting:function(){var e=this.$el.find(".planet-greeting"),o=this.$el.find(".planet-personality"),t=e.find(".message");t.length>0&&(this.talkSound(),t.length>1?(e.find(".active").removeClass("active"),t.first().addClass("active"),e.removeClass("hide-instructions")):(e.addClass("hide-instructions"),t.first().addClass("active")),tween.to(e,.7,{autoAlpha:1})),tween.to(o,.7,{autoAlpha:1}),skydock.views.ship.dockedPlanet=this},hideGreeting:function(){var e=this.$el.find(".planet-greeting"),o=this.$el.find(".planet-personality"),t=e.find(".message");t.length>0&&tween.to(e,.7,{autoAlpha:0}),tween.to(o,.7,{autoAlpha:.2})},nextMessage:function(){var e=this.$el.find(".message.active"),o=e.next(".message");o.length>0&&(this.talkSound(),e.removeClass("active"),o.addClass("active"),0===o.next(".message").length&&o.parent().addClass("hide-instructions"))},talkSound:function(){5===skydock.talkingCounter?skydock.talkingCounter=1:skydock.talkingCounter++,skydock.sounds["talking"+skydock.talkingCounter].play()}}),skydock.viewTemplates.JasonView=skydock.viewTemplates.PlanetView.extend({firstLanding:!1,showGreeting:function(){skydock.viewTemplates.PlanetView.prototype.showGreeting.apply(this),this.firstLanding===!1&&(skydock.views.ship.dockedPlanet=void 0,this.$el.find(".planet-greeting").addClass("hide-instructions"))},landing:function(){skydock.viewTemplates.PlanetView.prototype.landing.apply(this),this.firstLanding===!1&&(skydock.views.ship.dockedPlanet=this,this.$el.find(".planet-greeting").removeClass("hide-instructions"),this.nextMessage(),this.$el.find(".message").first().remove(),skydock.views.ship.speed=500,this.firstLanding=!0)}}),skydock.viewTemplates.StephanieView=skydock.viewTemplates.PlanetView.extend({firstLanding:!1,showGreeting:function(){skydock.viewTemplates.PlanetView.prototype.showGreeting.apply(this),this.firstLanding===!1&&(skydock.views.ship.dockedPlanet=void 0,this.$el.find(".planet-greeting").addClass("hide-instructions"))},landing:function(){skydock.viewTemplates.PlanetView.prototype.landing.apply(this),this.firstLanding===!1&&(skydock.views.ship.dockedPlanet=this,this.$el.find(".planet-greeting").removeClass("hide-instructions"),this.nextMessage(),this.$el.find(".message").first().remove(),this.firstLanding=!0)},nextMessage:function(){skydock.viewTemplates.PlanetView.prototype.nextMessage.apply(this);var e=this.$el.find(".message.active");e.length>0&&(-1!==e.text().indexOf("how you helped us")?e.siblings().remove():-1!==e.text().indexOf("gold star")&&skydock.views.goldStar.award())}}),skydock.viewTemplates.GoldStarView=Backbone.View.extend({el:"#gold-star",events:{click:"onClick"},onClick:function(){skydock.sounds.coin.play(),this.$el.toggleClass("flipped")},award:function(){skydock.views.goldStar.$el.show(),skydock.sounds.powerup.play(),tween.to(skydock.views.goldStar.$el,.6,{autoAlpha:1,onComplete:function(){skydock.sounds.coin.play(),tween.to(skydock.views.goldStar.$el,2,{ease:Quad.EaseInOut,width:80,height:80,marginLeft:0,marginTop:-100,top:"100%",left:20,autoAlpha:.7,delay:1.5})}}),skydock.views.ship.speed=750}}),skydock.viewTemplates.CreditsView=Backbone.View.extend({el:"#credits",events:{"click .close":"unrender"},render:function(){tween.to(this.$el,.6,{autoAlpha:1})},unrender:function(){tween.to(this.$el,.6,{autoAlpha:0})}})}();