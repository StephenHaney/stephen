!function(){"use strict";window.textures=PIXI.loader.resources,window.Sprite=PIXI.Sprite,window.constants={worldWidth:1920,worldHeight:1080,gridCellWidth:60,gridCellHeight:60,debug:!1},window.constants.worldWidthCenter=window.constants.worldWidth/2,window.constants.worldHeightCenter=window.constants.worldHeight/2}(),function(){"use strict";window.collision={hitTestRectangle:function(e,t){var i,o,s,n,r=e.position.x+e.origin.x,a=e.position.y+e.origin.y,h=t.position.x+t.origin.x,l=t.position.y+t.origin.y;return s=r-h,n=a-l,i=e.origin.x+t.origin.x,o=e.origin.y+t.origin.y,Math.abs(s)<i&&Math.abs(n)<o}}}(),function(){"use strict";window.soundManager={sounds:{},snakeEatingSounds:["om","nom","nom2"],initialize:function(){var e=["bummerMenu1C","firstItem1C","gameOver","goalItem2B","greenUiMenuPopupMessage04","nom","nom2","om","powerItem3A","preciseItem5C","redYellowUIMenuButtonBeep13"];this.sounds.snakeTheme=new Howl({src:"sounds/snakeTheme.mp3",autoplay:!0,loop:!0,volume:.2});for(var t=0;t<e.length;t++)this.sounds[e[t]]=new Howl({src:"sounds/"+e[t]+".mp3",volume:.6})},playSound:function(e){return"undefined"!=typeof this.sounds[e]&&(this.sounds[e].play(),!0)}}}(),function(){"use strict";window.grove={gameId:0,renderer:new PIXI.autoDetectRenderer(window.worldWidth,window.worldHeight),camera:new PIXI.Container,dust:new Dust(PIXI),currentKeyboard:{},lastUpdate:0,paused:!0,world:null,menu:null,hud:null,gameOverScreen:null,startScreen:null,initialize:function(){grove.startScreen.initialize(),grove.world.initialize(),grove.hud.initialize(),grove.menu.initialize(),grove.gameOverScreen.initialize(),grove.camera.addChild(grove.world.stage),grove.camera.addChild(grove.startScreen.stage),grove.camera.addChild(grove.hud.stage),grove.camera.addChild(grove.menu.stage),grove.renderer.backgroundColor=11184810,document.body.appendChild(grove.renderer.view),grove.initialLoad(),grove.scaleCanvasToScreen(),window.addEventListener("resize",grove.scaleCanvasToScreen,!1),window.addEventListener("keydown",grove.keyDown),window.addEventListener("keyup",grove.keyUp),window.onblur=grove.lostWindowFocus,window.onfocus=grove.gainedWindowFocus},onDoneLoading:function(e,t){textures.environment=textures.environmentAtlas.textures,grove.startScreen.onDoneLoading(),grove.menu.onDoneLoading(),grove.world.onDoneLoading(),grove.hud.onDoneLoading(),grove.gameOverScreen.onDoneLoading(),grove.paused=!1,grove.loopy();var i=document.getElementById("loading-div");i.parentNode.removeChild(i)},initialLoad:function(){PIXI.loader.add("startScreen","img/start-screen.png").add("environmentAtlas","img/environment.json").add("star","img/star.png").add("scoreboard","img/scoreboard.png").load(grove.onDoneLoading)},scaleCanvasToScreen:function(){var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=constants.worldHeight-t,o=constants.worldWidth-e,s=1,n=1,r=1;s=1-i/constants.worldHeight,n=1-o/constants.worldWidth,r=s<n?s:n;var a=constants.worldHeight*r,h=constants.worldWidth*r;grove.renderer.resize(h,a),grove.camera.scale.x=grove.camera.scale.y=r},keyDown:function(e){grove.currentKeyboard[e.keyCode]=!0,27===e.keyCode&&(grove.menu.isOpen?grove.menu.closeMenu:grove.menu.openMenu)(),32===e.keyCode&&grove.world.requestNewGame()},keyUp:function(e){grove.currentKeyboard[e.keyCode]=!1},lostWindowFocus:function(e){grove.currentKeyboard={},grove.world._gameOver===!1&&grove.menu.openMenu()},gainedWindowFocus:function(e){grove.world._paused&&grove.menu.isOpen===!1},loopy:function(){if(requestAnimationFrame(grove.loopy),!grove.paused){var e=Date.now(),t=e-grove.lastUpdate;grove.lastUpdate=e,t>100&&(console.log("Game loop lag: "+t),t=100),grove.dust.update(),grove.update(t),grove.drawAllTheThings(t)}},update:function(e){grove.world.update(e),grove.hud.update(e)},drawAllTheThings:function(e){grove.renderer.render(grove.camera)}}}(),function(){"use strict";grove.menu={stage:new PIXI.Container,isOpen:!1,size:{width:600,height:1920},initialize:function(){this.stage.position.x=-this.size.width,this.stage.visible=!1;var e=new PIXI.Graphics;e.beginFill(15856113),e.drawRect(0,0,this.size.width,this.size.height),e.endFill(),e.alpha=.9,this.stage.addChild(e)},onDoneLoading:function(){},openMenu:function(){grove.menu.isOpen=!0,grove.menu.stage.visible=!0,tween.to(grove.menu.stage.position,.35,{x:0,ease:Power3.easeOut}),grove.hud.showPausedText(),grove.world.pauseWorld()},closeMenu:function(){tween.to(grove.menu.stage.position,.35,{x:-grove.menu.size.width,ease:Power3.easeOut,onComplete:function(){grove.menu.isOpen=!1,grove.menu.stage.visible=!1,grove.world.resumeFromPause()}}),grove.hud.hidePausedText()}}}(),function(){"use strict";grove.world={stage:new PIXI.Container,background:null,objectTemplates:{},hero:null,goal:null,obstacles:[],score:0,_paused:!0,_gameOver:!0,_resumeInProgress:!1,resumingFromPauseTimeout:null,initialize:function(){},onDoneLoading:function(){this.background=new PIXI.extras.TilingSprite(textures.environment["grass-texture.png"],constants.worldWidth,constants.worldHeight),this.stage.addChild(this.background),this.loadLevel(),this.hero=new this.objectTemplates.Hero,this.stage.addChild(this.hero.graphic),this.hero.spawnInitialSegments(),this.goal=new this.objectTemplates.Goal,this.stage.addChild(this.goal.graphic),this.stage.addChild(this.goal.particleContainer),ga("send","event","snakejoy","start game","fresh start")},update:function(e){this._paused||this._gameOver||(this.hero.update(e),this.goal.update(e))},pauseWorld:function(){clearTimeout(this.resumingFromPauseTimeout),grove.world._paused=!0,grove.world._resumeInProgress=!1,soundManager.sounds.snakeTheme.fade(.3,.1,350),ga("send","event","snakejoy","pause")},resumeFromPause:function(){this._paused===!1||this._gameOver||this._resumeInProgress||(this._resumeInProgress=!0,soundManager.sounds.snakeTheme.fade(.1,.3,350),grove.hud.showAchievementText("On Your Mark",1),soundManager.playSound("redYellowUIMenuButtonBeep13"),grove.world.resumingFromPauseTimeout=setTimeout(function(){grove.hud.showAchievementText("Get Set!",1),soundManager.playSound("redYellowUIMenuButtonBeep13"),grove.world.resumingFromPauseTimeout=setTimeout(function(){grove.hud.showAchievementText("Go!!!",1),soundManager.playSound("greenUiMenuPopupMessage04"),grove.world.resumingFromPauseTimeout=setTimeout(function(){grove.world._paused=!1,grove.world._resumeInProgress=!1,grove.world.hero.lastGoalTime=grove.lastUpdate},500)},1100)},1100),ga("send","event","snakejoy","unpause"))},onGameOver:function(){this._gameOver||(this._gameOver=!0,console.log("GAME OVER"),grove.gameOverScreen.onEnter(),grove.camera.addChild(grove.gameOverScreen.stage),ga("send","event","snakejoy","game over",grove.world.score),grove.gameOverScreen.submitHighScore(),tween.to(this.hero.graphic,3.5,{alpha:0}),soundManager.playSound("gameOver"))},requestNewGame:function(){this._gameOver!==!1&&(this.pauseWorld(),this.score=0,this.hero.reset(),this.goal.reposition(),this._gameOver=!1,grove.startScreen.onLeave(),grove.camera.removeChild(grove.gameOverScreen.stage),grove.gameOverScreen.onLeave(),this.resumeFromPause(),ga("send","event","snakejoy","start game","restart"))},addScore:function(e,t){"undefined"==typeof t&&(t=!1),"undefined"==typeof e&&(e=50),this.score+=e;var i=e;return this.score%50===0&&(i=i<50?50:i,this.score%100===0&&(i=i<100?100:i,this.score%1e3===0&&(i=i<1e3?1e3:i))),grove.hud.starExplosion(i),e},loadLevel:function(){var e={width:constants.worldWidth,height:constants.gridCellHeight},t={x:0,y:0},i=new this.objectTemplates.Obstacle;i.tileSprite=new PIXI.extras.TilingSprite(textures.environment["stone-wall-top.png"],e.width,e.height),i.placeInWorld(e,t),this.obstacles.push(i),this.stage.addChild(i.tileSprite);var o={x:0,y:constants.worldHeight-constants.gridCellHeight},s=new this.objectTemplates.Obstacle;s.tileSprite=new PIXI.extras.TilingSprite(textures.environment["stone-wall-bottom.png"],e.width,e.height),s.placeInWorld(e,o),this.obstacles.push(s),this.stage.addChild(s.tileSprite);var n={width:constants.gridCellWidth,height:constants.worldHeight},r={x:0,y:0},a=new this.objectTemplates.Obstacle;a.tileSprite=new PIXI.extras.TilingSprite(textures.environment["stone-wall-left.png"],n.width,n.height),a.placeInWorld(n,r),this.obstacles.push(a),this.stage.addChild(a.tileSprite);var h={x:constants.worldWidth-constants.gridCellWidth,y:0},l=new this.objectTemplates.Obstacle;l.tileSprite=new PIXI.extras.TilingSprite(textures.environment["stone-wall-right.png"],n.width,n.height),l.placeInWorld(n,h),this.obstacles.push(l),this.stage.addChild(l.tileSprite);var d=new PIXI.Sprite(textures.environment["stone-wall-corner.png"]);d.position.x=constants.worldWidth-constants.gridCellWidth,d.position.y=0,d.size={width:constants.gridCellWidth,height:constants.gridCellHeight},this.stage.addChild(d);var g=new PIXI.Sprite(textures.environment["stone-wall-corner.png"]);g.size={width:constants.gridCellWidth,height:constants.gridCellHeight},g.anchor.set(.5,.5),g.rotation=Math.PI/2,g.position.x=constants.worldWidth-constants.gridCellWidth/2,g.position.y=constants.worldHeight-constants.gridCellHeight/2,this.stage.addChild(g);var c=new PIXI.Sprite(textures.environment["stone-wall-corner.png"]);c.size={width:constants.gridCellWidth,height:constants.gridCellHeight},c.anchor.set(.5,.5),c.rotation=Math.PI,c.position.x=constants.gridCellWidth/2,c.position.y=constants.worldHeight-constants.gridCellHeight/2,this.stage.addChild(c);var u=new PIXI.Sprite(textures.environment["stone-wall-corner.png"]);u.size={width:constants.gridCellWidth,height:constants.gridCellHeight},u.anchor.set(.5,.5),u.rotation=1.5*Math.PI,u.position.x=constants.gridCellWidth/2,u.position.y=constants.gridCellHeight/2,this.stage.addChild(u)}}}(),function(){"use strict";grove.hud={stage:new PIXI.Container,scoreboardPosition:{x:96,y:50},scoreText:new PIXI.Text,scoreboardBackground:null,scoreboardParticleContainer:null,scrollingCombatText:new PIXI.Text,scrollingCombatTween:null,showFPS:!0,fpsText:new PIXI.Text,framesInLastSecond:0,timeSinceFPSReset:0,achievementAnimationInProgress:!1,achievementText:new PIXI.Text,pausedText:new PIXI.Text,pausedTextTween:null,initialize:function(){constants.debug&&this.buildFPSBlock(),this.buildAchievementDisplay(),this.buildScrollingCombatDisplay(),this.buildPausedDisplay()},onDoneLoading:function(){this.buildScoreBlock()},update:function(e){constants.debug&&(this.timeSinceFPSReset+=e,this.framesInLastSecond++,this.timeSinceFPSReset>=1e3&&(this.fpsText.text="FPS: "+this.framesInLastSecond,this.framesInLastSecond=0,this.timeSinceFPSReset=0)),this.scoreText.text=String(grove.world.score)},buildScrollingCombatDisplay:function(){this.scrollingCombatText.style={fill:"#296100",fontFamily:"impact",fontSize:"100px",lineJoin:"round",stroke:"#fff",strokeThickness:10,align:"center"},this.scrollingCombatText.anchor={x:.5,y:.5},this.scrollingCombatText.alpha=0,this.stage.addChild(this.scrollingCombatText)},buildPausedDisplay:function(){this.pausedText.style={fill:"#fff",fontFamily:"impact",fontSize:"80px",lineJoin:"round",stroke:"#434343",strokeThickness:10,align:"center"},this.pausedText.text="PRESS ESC TO RESUME",this.pausedText.anchor={x:0,y:.5},this.pausedText.position={x:810,y:920},this.pausedText.alpha=0,this.stage.addChild(this.pausedText)},buildAchievementDisplay:function(){this.achievementText.style={fill:"#fff",fontFamily:"impact",fontSize:"100px",stroke:"#434343",strokeThickness:10,lineJoin:"round",align:"center"},this.achievementText.anchor={x:.5,y:.5},this.achievementText.position.set(constants.worldWidthCenter,constants.worldHeightCenter),this.achievementText.alpha=0,this.stage.addChild(this.achievementText)},buildScoreBlock:function(){this.scoreboardBackground=new PIXI.Sprite(textures.scoreboard.texture,164,79),this.scoreboardBackground.position.set(this.scoreboardPosition.x,this.scoreboardPosition.y),this.scoreboardBackground.anchor={x:.5,y:.5},this.stage.addChild(this.scoreboardBackground),this.scoreText.style={fill:"#ffcc00",fontFamily:"impact",fontSize:"45px",stroke:"#9f882a",strokeThickness:6,lineJoin:"round",align:"center"},this.scoreText.text="0",this.scoreText.position.set(this.scoreboardPosition.x,this.scoreboardPosition.y),this.scoreText.anchor={x:.5,y:.5},this.stage.addChild(this.scoreText),this.scoreboardParticleContainer=new PIXI.particles.ParticleContainer(15e3,{alpha:!0,scale:!0,rotation:!0,uvs:!0}),this.stage.addChild(this.scoreboardParticleContainer)},buildFPSBlock:function(){var e=new PIXI.Graphics;e.beginFill(16777215,.6),e.drawRect(constants.worldWidth-260,constants.worldHeight-50,260,50),e.endFill(),this.stage.addChild(e),this.fpsText.style={fill:"black",fontFamily:"sans-serif",fontSize:"32px"},this.fpsText.position.set(constants.worldWidth-240,constants.worldHeight-41),this.stage.addChild(this.fpsText)},starExplosion:function(e){var t=32,i=64,o=.025,s=.0425,n=!1,r=.15;e>=50&&(i*=1.5,o*=.5,s*=.5,r=.09),grove.dust.create(this.scoreboardPosition.x,this.scoreboardPosition.y,function(){return new PIXI.Sprite(textures.star.texture)},this.scoreboardParticleContainer,e,r,n,0,6.28,t,i,1,2,.005,.01,o,s,.05,.1)},scrollTheCombatText:function(e,t){if(null!==this.scrollingCombatTween)for(var i=0;i<this.scrollingCombatTween.length;i++)this.scrollingCombatTween[i].kill();var o={x:t.x+constants.gridCellWidth/2,y:t.y+constants.gridCellHeight/2};this.scrollingCombatText.alpha=1,this.scrollingCombatText.scale.x=.5,this.scrollingCombatText.scale.y=.5,this.scrollingCombatText.text=e,this.scrollingCombatText.position.set(o.x,o.y),this.scrollingCombatTween=[tween.to(this.scrollingCombatText,1.6,{alpha:0,y:"-=80",ease:Power4.easeOut}),tween.to(this.scrollingCombatText.scale,1.6,{x:1,y:1,ease:Power4.easeOut})]},showPausedText:function(){tween.to(grove.hud.pausedText,.5,{alpha:1,ease:Power3.easeOut,onComplete:function(){grove.hud.pausedTextTween=tween.to(grove.hud.pausedText,1.1,{alpha:"-=0.725",repeat:-1,yoyo:!0,ease:Power1.easeOut})}})},hidePausedText:function(){grove.hud.pausedTextTween&&grove.hud.pausedTextTween.kill(),tween.to(grove.hud.pausedText,.5,{alpha:0,ease:Power3.easeOut})},showAchievementText:function(e,t){this.achievementAnimationInProgress||(this.achievementAnimationInProgress=!0,"undefined"==typeof t&&(t=1.6),this.achievementText.text=e,this.achievementText.alpha=0,this.achievementText.x=constants.worldWidthCenter-150,this.stage.addChild(this.achievementText),tween.to(this.achievementText,t,{x:"+=300",ease:Circ.easeOut,onComplete:function(){grove.hud.achievementAnimationInProgress=!1}}),tween.to(this.achievementText,t/2,{alpha:.55,onComplete:function(){this.reverse()}}))}}}(),function(){"use strict";grove.achievements={checkForGoalAchievements:function(){var e=grove.lastUpdate,t=0,i=!1;return null!==grove.world.hero.lastGoalTime&&(t=e-grove.world.hero.lastGoalTime),0===grove.world.score?(this.triggerFirstTimerAchievement(),i=!0):grove.world.hero.movesSinceLastGoal<=1?(this.triggerPreciseAchievement(),i=!0):t<=1300?(this.triggerQuickAchievement(),i=!0):t<=1650&&(this.triggerGoodAchievement(),i=!0),grove.world.hero.movesSinceLastGoal>=20&&(this.triggerLongWayAchievement(),i=!0),t>=8e3&&(this.triggerReallySlowAchievement(),i=!0),grove.world.hero.movesSinceLastGoal=0,grove.world.hero.lastGoalTime=e,i},triggerFirstTimerAchievement:function(){grove.hud.showAchievementText("D E L I C I O U S  + 2 5 0"),grove.world.addScore(250),soundManager.playSound("firstItem1C")},triggerPreciseAchievement:function(){grove.hud.showAchievementText("P R E C I S E  + 1 0 0 0"),grove.world.addScore(1e3),soundManager.playSound("preciseItem5C")},triggerQuickAchievement:function(){grove.hud.showAchievementText("Q U I C K  + 5 0 0"),grove.world.addScore(500),soundManager.playSound("powerItem3A")},triggerGoodAchievement:function(){grove.hud.showAchievementText("G O O D  + 2 0 0"),grove.world.addScore(200),soundManager.playSound("goalItem2B")},triggerLongWayAchievement:function(){grove.hud.showAchievementText("T H E  L O N G  W A Y  - 2 0"),grove.world.addScore(-20),soundManager.playSound("bummerMenu1C")},triggerReallySlowAchievement:function(){grove.hud.showAchievementText("S N A I L  - 1 0"),grove.world.addScore(-10),soundManager.playSound("bummerMenu1C")}}}(),function(){"use strict";grove.gameOverScreen={stage:new PIXI.Container,playerName:null,banner:null,highScoresContainer:new PIXI.Container,highScoreTitleText:new PIXI.Text,highScoreTexts:[],highScoreData:{today:[],overall:[]},seedTodayData:[{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"Sharky",NewlyAdded:!1,Score:6550,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"Roger",NewlyAdded:!1,Score:5250,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"Roger",NewlyAdded:!1,Score:5e3,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"Sharky",NewlyAdded:!1,Score:3250,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"Sharky",NewlyAdded:!1,Score:3200,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"Roger",NewlyAdded:!1,Score:2550,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"Roger",NewlyAdded:!1,Score:1250,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"w",NewlyAdded:!1,Score:800,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"w",NewlyAdded:!1,Score:350,ScoreId:-1},{CreatedDate:new Date,GameId:String(grove.gameId),IPAddress:"0",Name:"w",NewlyAdded:!1,Score:100,ScoreId:-1}],highScoreFillerNames:["Aardvark","Albatross","Alligator","Alpaca","Ant","Anteater","Antelope","Ape","Armadillo","Baboon","Badger","Barracuda","Bat","Bear","Beaver","Bee","Bison","Boar","Buffalo","Butterfly","Camel","Cat","Caterpillar","Cheetah","Chicken","Chimpanzee","Chinchilla","Cobra","Cockroach","Coyote","Crab","Crocodile","Crow","Dog","Dolphin","Donkey","Dove","Dragonfly","Duck","Eagle","Echidna","Eel","Elephant","Elk","Falcon","Ferret","Finch","Fish","Flamingo","Fox","Frog","Gazelle","Gerbil","Giraffe","Gnat","Goat","Goose","Gorilla","Grasshopper","Guinea fowl","Guinea pig","Gull","Hamster","Hare","Hawk","Hedgehog","Heron","Herring","Hippopotamus","Hornet","Hummingbird","Hyena","Jackal","Jaguar","Jellyfish","Kangaroo","Koala","Komodo dragon","Lark","Lemur","Leopard","Lion","Llama","Lobster","Mallard","Mammoth","Manatee","Mink","Mole","Mongoose","Monkey","Moose","Mouse","Mosquito","Narwhal","Newt","Nightingale","Octopus","Opossum","Ostrich","Otter","Owl","Panther","Parrot","Panda","Pelican","Penguin","Pig","Pigeon","Polar bear","Porcupine","Porpoise","Prairie dog","Quail","Rabbit","Raccoon","Ram","Raven","Reindeer","Rhinoceros","Salamander","Salmon","Sand dollar","Sandpiper","Sardine","Sea lion","Sea urchin","Seahorse","Seal","Shark","Sheep","Skunk","Sloth","Snail","Snake","Spider","Squirrel","Starling","Stegosaurus","Swan","Termite","Tiger","Toad","Turkey","Turtle","Wallaby","Walrus","Wasp","Weasel","Whale","Wolf","Wolverine","Wombat","Wren","Yak","Zebra"],startNewGameText:new PIXI.Text,startNewGameAnimation:null,initialize:function(){},onDoneLoading:function(){this.buildHighScoresDisplay(),this.banner=document.querySelector("#high-score-banner")},update:function(e){},onEnter:function(){this.highScoresContainer.alpha=0,this.startNewGameText.alpha=1,this.startNewGameAnimation=tween.to(this.startNewGameText,1.1,{alpha:"-=0.725",repeat:-1,yoyo:!0}),null!==grove.gameOverScreen.banner&&grove.gameOverScreen.banner.classList.add("is-showing")},onLeave:function(){this.startNewGameAnimation&&this.startNewGameAnimation.kill(),null!==grove.gameOverScreen.banner&&grove.gameOverScreen.banner.classList.remove("is-showing")},buildHighScoresDisplay:function(){this.highScoresContainer.alpha=0,this.highScoresContainer.position.set(constants.worldWidthCenter,110);var e={fill:"#fff",fontFamily:"impact",fontSize:"36px",stroke:"#434343",strokeThickness:7,lineJoin:"round"};this.startNewGameText.style=e,this.startNewGameText.style.font="52px impact",this.startNewGameText.anchor.set(.5,0),this.startNewGameText.position.set(constants.worldWidthCenter,100),this.startNewGameText.text="PRESS SPACE FOR NEW GAME",this.stage.addChild(this.startNewGameText);for(var t=70,i=11*t,o=0;o<22;o++){var s=new PIXI.Text;s.style=e;var n=Math.floor(o/11),r=t*o-n*i,a=-550+1100*n;s.anchor.set(.5,.5),s.position.set(a,r),this.highScoresContainer.addChild(s),this.highScoreTexts.push(s)}this.stage.addChild(this.highScoresContainer)},showHighScores:function(){this.highScoresContainer.alpha=0;var e=_.sortBy(grove.gameOverScreen.highScoreData.overall,function(e){return-e.Score}),t=_.sortBy(grove.gameOverScreen.highScoreData.today,function(e){return-e.Score}),i={fontFamily:"impact",fontSize:"26px",strokeThickness:4,stroke:"#434343",fill:"#fff"};this.highScoreTexts[0].text="TODAY",this.highScoreTexts[0].style=i,this.highScoreTexts[11].text="ALL TIME",this.highScoreTexts[11].style=i;for(var o,s,n,r=0;r<10;r++)n=t[r],n.NewlyAdded?(o="#9f882a",s="#ffcc00"):(o="#434343",s="#fff"),this.highScoreTexts[r+1].style.stroke=o,this.highScoreTexts[r+1].style.fill=s,this.highScoreTexts[r+1].text=r+1+" | "+n.Name+" | "+n.Score.toFixed(0)+"\n";for(r=0;r<10;r++)n=e[r],n.NewlyAdded?(o="#9f882a",s="#ffcc00"):(o="#434343",s="#fff"),this.highScoreTexts[r+12].style.stroke=o,this.highScoreTexts[r+12].style.fill=s,this.highScoreTexts[r+12].text=r+1+" | "+n.Name+" | "+n.Score.toFixed(0)+"\n";tween.to(grove.gameOverScreen.highScoresContainer,1,{alpha:1})},getAnonymousNickname:function(e){var t=Math.floor(Math.random()*this.highScoreFillerNames.length);return this.highScoreFillerNames[t]},submitHighScore:function(){if(null===this.playerName){var e=prompt("Please enter your nickname for high scores","");null!==e&&0!==e.length||(e=this.getAnonymousNickname()),this.playerName=e}var t={GameId:String(grove.gameId),Score:grove.world.score,Name:this.playerName},i=new XMLHttpRequest;i.open("POST","http://joyfulgames.azurewebsites.net/api/HighScores",!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.send(JSON.stringify(t)),i.onload=function(){if(i.status>=200&&i.status<400){var e=JSON.parse(i.responseText);e.today.push.apply(e.today,grove.gameOverScreen.seedTodayData),grove.gameOverScreen.highScoreData.today=e.today,grove.gameOverScreen.highScoreData.overall=e.overall,grove.gameOverScreen.showHighScores()}else console.log(i)},i.onerror=function(){console.log(i)}}}}(),function(){"use strict";grove.startScreen={stage:new PIXI.Container,startNewGameAnimation:null,initialize:function(){},onDoneLoading:function(){var e=new PIXI.Sprite(textures.startScreen.texture,1251,785);e.anchor={x:.5,y:0},e.position.set(960,150),this.stage.addChild(e);var t=new PIXI.Text;t.style={fill:"#fff",fontFamily:"impact",fontSize:"42px",lineJoin:"round",align:"center",letterSpacing:6},t.text="PRESS SPACE TO START",t.position.set(960,894),t.anchor={x:.5,y:.5},this.stage.addChild(t),this.startNewGameAnimation=tween.to(t,1.1,{alpha:"-=0.725",repeat:-1,yoyo:!0})},update:function(e){},onEnter:function(){},onLeave:function(){this.startNewGameAnimation&&this.startNewGameAnimation.kill(),tween.to(this.stage,.5,{alpha:"0",onComplete:function(){grove.camera.removeChild(this.stage)}})}}}(),function(){"use strict";grove.world.objectTemplates.Hero=function(){this.graphic=new PIXI.Graphics,this.segmentSize={width:constants.gridCellWidth,height:constants.gridCellHeight},this.origin={x:this.segmentSize.width/2,y:this.segmentSize.height/2},this.face={eyeballs:{left:{x:0,y:0},right:{x:0,y:0}}},this.position={x:0,y:0},this.graphic.position.x=this.position.x,this.graphic.position.y=this.position.y,this.nextVector=null,this.radiansToGoal=0,this.segments=[],this.initialSegmentCount=6,this.segmentsToAddCount=0,this.updatesSinceVectorChange=0,this.bounds={minX:constants.gridCellWidth,maxX:constants.worldWidth-constants.gridCellWidth-this.segmentSize.width,minY:constants.gridCellHeight,maxY:constants.worldHeight-constants.gridCellHeight-this.segmentSize.height},this.movesSinceLastGoal=0,this.lastGoalTime=null,this.update=function(e){this.updatesSinceVectorChange++,this.timeSinceLastGoal+=e;var t=grove.currentKeyboard[38]===!0||grove.currentKeyboard[87]===!0,i=grove.currentKeyboard[40]===!0||grove.currentKeyboard[83]===!0,o=grove.currentKeyboard[37]===!0||grove.currentKeyboard[65]===!0,s=grove.currentKeyboard[39]===!0||grove.currentKeyboard[68]===!0;t&&0===this.segments[0].vector.y&&(this.nextVector={x:0,y:-1}),i&&0===this.segments[0].vector.y&&(this.nextVector={x:0,y:1}),o&&0===this.segments[0].vector.x?this.nextVector={x:-1,y:0}:s&&0===this.segments[0].vector.x&&(this.nextVector={x:1,y:0}),this.graphic.clear(),this.graphic.beginFill(10330160);for(var n=0;n<this.segments.length;n++){if(this.segments[n].position.x+=this.segments[n].vector.x*this.segments[n].size.width*.2,this.segments[n].position.y+=this.segments[n].vector.y*this.segments[n].size.height*.2,this.graphic.drawRect(this.segments[n].position.x,this.segments[n].position.y,this.segments[n].size.width,this.segments[n].size.height),n>3){var r=collision.hitTestRectangle(this.segments[0],this.segments[n]);r&&(grove.world.onGameOver(),ga("send","event","snakejoy","death","collided with self"))}var a=1-n/this.segments.length+.2;this.graphic.beginFill(2711808,a)}if(this.graphic.endFill(),this.radiansToGoal=Math.atan2(grove.world.goal.position.y+grove.world.goal.origin.y-(this.segments[0].position.y+this.segments[0].origin.y),grove.world.goal.position.x+grove.world.goal.origin.x-(this.segments[0].position.x+this.segments[0].origin.x)),this.drawTheFace(),!(this.checkForWallHit()||this.updatesSinceVectorChange<5)){this.updatesSinceVectorChange=0;for(var h=this.segments.length-1;h>0;h--){var l=h-1;this.segments[h].vector.x=this.segments[l].vector.x,this.segments[h].vector.y=this.segments[l].vector.y}for(null!==this.nextVector&&(this.segments[0].vector.x=this.nextVector.x,this.segments[0].vector.y=this.nextVector.y,this.nextVector=null,this.movesSinceLastGoal++,this.updateFacePosition());this.segmentsToAddCount>0;)this.spawnNewSegment(),this.segmentsToAddCount--}},this.checkForWallHit=function(){return(this.segments[0].position.x<this.bounds.minX||this.segments[0].position.x>this.bounds.maxX||this.segments[0].position.y<this.bounds.minY||this.segments[0].position.y>this.bounds.maxY)&&(grove.world.onGameOver(),ga("send","event","snakejoy","death","collided with wall"),!0)},this.updateFacePosition=function(){var e=15;this.segments[0].vector.x===-1?(this.face.eyeballs.left={x:e,y:this.segmentSize.height},this.face.eyeballs.right={x:e,y:0}):1===this.segments[0].vector.x?(this.face.eyeballs.left={x:this.segmentSize.width-e,y:0},this.face.eyeballs.right={x:this.segmentSize.width-e,y:this.segmentSize.height}):this.segments[0].vector.y===-1?(this.face.eyeballs.left={x:0,y:e},this.face.eyeballs.right={x:this.segmentSize.width,y:e}):1===this.segments[0].vector.y&&(this.face.eyeballs.left={x:this.segmentSize.width,y:this.segmentSize.height-e},this.face.eyeballs.right={x:0,y:this.segmentSize.height-e})},this.drawTheFace=function(){var e={x:this.segments[0].position.x+this.face.eyeballs.left.x,y:this.segments[0].position.y+this.face.eyeballs.left.y},t={x:this.segments[0].position.x+this.face.eyeballs.right.x,y:this.segments[0].position.y+this.face.eyeballs.right.y},i={x:6*Math.cos(this.radiansToGoal),y:6*Math.sin(this.radiansToGoal)},o={x:e.x+i.x,y:e.y+i.y},s={x:t.x+i.x,y:t.y+i.y};this.graphic.beginFill(15463644),this.graphic.drawCircle(e.x,e.y,9,9),this.graphic.drawCircle(t.x,t.y,9,9),this.graphic.endFill(),this.graphic.beginFill(806565),this.graphic.drawCircle(o.x,o.y,3,3),this.graphic.drawCircle(s.x,s.y,3,3),this.graphic.endFill()},this.reset=function(){this.segmentsToAddCount=0,this.updatesSinceVectorChange=0,this.nextVector=null,this.movesSinceLastGoal=0,this.lastGoalTime=null,this.segments=[],this.spawnInitialSegments(),this.update(0),tween.to(this.graphic,.8,{alpha:1})},this.spawnInitialSegments=function(){for(var e={x:960,y:this.initialSegmentCount*this.segmentSize.height},t=0;t<6;t++)grove.world.hero.segments.push({position:{x:e.x,y:e.y-this.segmentSize.height*t},vector:{x:0,y:1},size:{width:this.segmentSize.width,height:this.segmentSize.height},origin:{x:this.segmentSize.width/2,y:this.segmentSize.height/2}});this.updateFacePosition()},this.spawnNewSegment=function(){var e=this.segments[this.segments.length-1];this.segments.push({position:{x:e.position.x,y:e.position.y},vector:{x:0,y:0},size:{width:this.segmentSize.width,height:this.segmentSize.height},origin:{x:this.segmentSize.width/2,y:this.segmentSize.height/2}})}}}(),function(){"use strict";grove.world.objectTemplates.Goal=function(){this.graphic=new PIXI.Graphics,this.size={width:constants.gridCellWidth,height:constants.gridCellHeight},this.origin={x:this.size.width/2,y:this.size.height/2},this.position={x:-5e3,y:-5e3},this.graphic.beginFill(10027008),this.graphic.drawRect(0,0,this.size.width,this.size.height),this.graphic.endFill(),this.graphic.position=this.position,this.texture=grove.renderer.generateTexture(this.graphic),this.particleContainer=new PIXI.particles.ParticleContainer(15e3,{alpha:!0,scale:!0,rotation:!0,uvs:!0}),this.update=function(e){this.checkForSnakeHeadHit()},this.checkForSnakeHeadHit=function(){var e=grove.world.hero.segments[0],t=collision.hitTestRectangle(e,this);if(t){this.breakApart();var i={x:this.position.x,y:this.position.y};this.reposition(),grove.world.hero.segmentsToAddCount++;var o=(grove.achievements.checkForGoalAchievements(),grove.world.addScore());grove.hud.scrollTheCombatText(o,i);var s=Math.round(Math.random()*(soundManager.snakeEatingSounds.length-1));soundManager.playSound(soundManager.snakeEatingSounds[s]),console.log(s)}},this.reposition=function(e){if("undefined"==typeof e&&(e=0),e>200)return void console.log("Can not find a spot that is not the snake!?!?");for(var t={x:constants.worldWidth/this.size.width,y:constants.worldHeight/this.size.height},i={position:{x:Math.floor(Math.random()*t.x)*this.size.width,y:Math.floor(Math.random()*t.y)*this.size.height},size:{width:this.size.width,height:this.size.height},origin:{x:this.origin.x,y:this.origin.y}},o=!1,s=0;s<grove.world.hero.segments.length&&!(o=collision.hitTestRectangle(grove.world.hero.segments[s],i));s++);for(s=0;o===!1&&s<grove.world.obstacles.length&&!(o=collision.hitTestRectangle(grove.world.obstacles[s],i));s++);o===!1?(this.position={x:i.position.x,y:i.position.y},this.graphic.position.x=this.position.x,this.graphic.position.y=this.position.y):(console.log("new goal pos would have collided with the snake, trying again"),this.reposition(e+1))},this.breakApart=function(){var e=this,t=20,i=20,o=.02,s=.0275,n=!0,r=.05,a=6;grove.dust.create(this.position.x+this.origin.x,this.position.y+this.origin.y,function(){return new PIXI.Sprite(e.texture)},this.particleContainer,a,r,n,0,6.28,t,i,1.75,2,.002,.003,o,s,.075,.1)}}}(),function(){"use strict";grove.world.objectTemplates.Obstacle=function(){this.tileSprite=null,this.size={width:0,height:0},this.origin={x:0,y:0},this.position={x:-5e3,y:-5e3},this.placeInWorld=function(e,t){this.size=e,this.position=t,this.tileSprite.position.x=this.position.x,this.tileSprite.position.y=this.position.y,this.origin={x:this.size.width/2,y:this.size.height/2}}}}();